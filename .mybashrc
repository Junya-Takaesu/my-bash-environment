# Enable silent mode.
export MYBASH_SILENT=1

# Load utility functions which is required for this '.mybashrc'.
source $(dirname ${BASH_SOURCE[0]})/bash/utils.sh

#-------------------------------------------------
# Define aliases
#-------------------------------------------------
# alias claude='claude --permission-mode plan'

#-------------------------------------------------
# Load this '.mybashrc' from the real '~/.bashrc'
#-------------------------------------------------
main() {
    ACCUMULATED_OUTPUT=()
    SCRIPT_STATUS_TEMPLATE="%s %s %s"

    # BASH_SOURCE is a predifined variable which contains the
    # current script's location.(It might be relative path. Similar to $0)
    # See this for more infor:
    # https://stackoverflow.com/questions/35006457/choosing-between-0-and-bash-source
    SECRETS_DEFINITIONS=$(dirname ${BASH_SOURCE[0]})/secrets.sh
    DIR_FOR_SRC_SCRIPTS_HIGH_PRECEDENCE=$(dirname ${BASH_SOURCE[0]})/sources_high_precedence
    DIR_FOR_SRC_SCRIPTS=$(dirname ${BASH_SOURCE[0]})/sources

    _my_echo "\nLoading secrets..."
    source $SECRETS_DEFINITIONS
    _my_echo "\nLoading scripts with high priority..."
    _load_scripts $DIR_FOR_SRC_SCRIPTS_HIGH_PRECEDENCE
    _my_echo "\nLoading other scripts ..."
    _load_scripts $DIR_FOR_SRC_SCRIPTS

    # Display accumulated output
    for output in "${ACCUMULATED_OUTPUT[@]}"; do
        _my_echo "$output"
    done
    _my_banner
}

main
